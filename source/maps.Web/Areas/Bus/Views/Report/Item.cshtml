@model Report
@{
    ViewBag.Title = "#" + Model.ID + " " + Model.DateTime.Value.ToString("dd.MM.yyyy HH:mm");
    Layout = "~/Areas/Bus/Views/Shared/_Layout.cshtml";
    var currentUser = ((BaseController)ViewContext.Controller).CurrentUser;
}
<div class="row">
    <p></p>
</div>
<div class="row">
    <div class="col-sm-3 col-sm-offset-3">
        @if (Model.SubRules.Any())
        {
            foreach (var photo in Model.SubPhotos)
            {
                <div class="thumbnail">
                    @if (photo.ImagePath != null)
                    {
                        <img src="@photo.ImagePath?w=200&h=200&mode=crop" />
                    }
                </div>
            }
        }
    </div>
    <div class="col-sm-5">
        <h3><span class="label label-info">@Model.StatusStr</span></h3>
        @if (currentUser.InRoles("admin")) { 
            if (Model.Status == (int)Report.StatusEnum.New)
            {
                @Html.ActionLink("SMS", "SendSms", "Report", new { id = Model.ID }, new { @class = "btn btn-default" })
            }
        }
        <p>
            Натисніть @Html.ActionLink("Відповісти", "Answer", "Report", new { id = Model.ID }, new { @class = "btn btn-primary" }), якщо ви є перевізником даного автобусу.
        </p>

        <p>
            <strong>Дата: </strong>@Model.DateTime.Value.ToString("dd.MM.yyyy HH:mm")
        </p>
        <p>
            <strong>Автобус: </strong> #@Model.Route.Name @Model.Bus.Number @Model.Bus.Brand.Name
        </p>
        @if (Model.SubRules.Any())
        {
            <p>
                <strong>
                    Порушені правила :
                </strong>
                @foreach (var rule in Model.SubRules)
                {
                <p>
                    <h4> @rule.Name</h4>

                    @Html.Raw(rule.Description.NlToBr())
                    
                    @if (!string.IsNullOrWhiteSpace(rule.UrlToLaw))
                    {
                        <br/>
                        <a href="@rule.UrlToLaw">@rule.UrlToLaw</a>
                    }
                </p>
                }
                </p>
        }
        <p>
            <strong>  Опис : </strong>
            @Model.Description.NlToBr()
        </p>
        <p></p>
        
    </div>
</div>